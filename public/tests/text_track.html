<!DOCTYPE html>
<meta charset="utf-8">
<html>
    <head>
        <title>Text Track</title>
        <script src="../js/prong.js"></script>
        <link rel='stylesheet' href='testPage.css'></link>
        <script src="qadi-min.js"></script>
        <link rel="stylesheet" type="text/css" href="qadi.css"/>
    </head>
    <body>

        <iframe src="./"></iframe>
        <div id="main">
        Text Track<br />
        <br />
        <ul id="qadi" style="font-size:10pt">
            <li>The first track is called 'chords' and shows you which chord
            is being played at each point in the piece
            </li>
            <li>If you click on the timeline to change the position of the play
            line, then the chord changes to the correct one for the selected
            time
            </li>
            <li>If you play the sequence, then the chords will change
            at the correct moment</li>
            </li>
            <li>If you loop around a chord change, then the chord changes
            correctly after looping
            </li>
            
        </ul>
        <span>
        <br />
        </span>
        <div id="transport"></div>
        <div id="sequence"></div>
        </div>
        <script>

var root = 'https://dl.dropboxusercontent.com/u/5613860/audio/nino_rota/'

var chords = [
    {
        time : 1,
        text : 'Eb'
    },
    {
        time : 7.5,
        text : 'Bb'
    },
    {
        time : 16.2,
        text : 'Eb'
    },
    {
        time : 25,
        text : 'F'
    },
    {
        time : 33.5,
        text : 'Eb'
    },
    {
        time : 42.25,
        text : 'Bb'
    },
    {
        time : 51,
        text : 'Eb'
    }
]


var tracks = [
    {
        'type' : 'text',
        'name' : 'chords',
        'data' : chords
    },
    {
        'type' : 'audio',
        'src' : root + 'sax1.mp3'
    },
    {
        'type' : 'audio',
        'src' : root + 'tuba.mp3'
    }
]

var d3 = prong.d3;
var x = d3.scale.linear().domain([0, 60]).range([0, 400]);

sequence = prong.sequence()
    .x(x)
    .tracks(tracks)
    .trackHeight(60)
    .canSelectLoop(true)
    .historyKey('s')
    //.scrollZone(d3.select('#sequence'))
    .audioOut(prong.audioContext().destination);

transport = prong.transport().sequence(sequence)

d3.select('#sequence').call(sequence);
d3.select('#transport').call(transport);
        </script>
    </body>
</html>